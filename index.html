<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Centro de Mando V7.6: Speed Edition</title>
    
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#000000">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2666/2666505.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: { extend: { fontFamily: { sans: ['Inter', 'sans-serif'] } } }
        }
    </script>
    
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://apis.google.com/js/api.js" async defer></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;900&display=swap');
        
        body { background-color: #000; touch-action: none; overscroll-behavior: none; }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Efecto Cristal (Glass) */
        .glass-panel {
            background: rgba(10, 10, 10, 0.65);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 -10px 50px rgba(0, 0, 0, 0.8);
        }

        .drawer-transition { transition: height 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); }

        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100%); }
        }
        .bio-scan::after {
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: scanline 2s linear infinite; pointer-events: none;
        }

        .droppable-area.drag-over {
            background-color: rgba(255, 255, 255, 0.05);
            border-color: var(--theme-color);
            box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.05);
        }
        .draggable-item:active { cursor: grabbing; }
        
        /* Renderizado HTML seguro */
        .rich-text b, .rich-text strong { color: inherit; font-weight: 900; }
        .rich-text i, .rich-text em { font-style: italic; opacity: 0.9; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect, useRef, useMemo, useCallback } from 'https://esm.sh/react@18.2.0';
        import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client';
        import { 
            Calendar, CheckSquare, Settings, RefreshCw, Plus, ChevronLeft, ChevronRight, Menu, X, 
            Target, Folder, BookOpen, Clock, Trash2, Edit3, GripHorizontal, CheckCircle,
            Dna, Microscope, Activity, Leaf, Zap, Globe, Database, Cpu, Layout, PenTool, Hash, Briefcase, Terminal,
            GraduationCap, Eye, EyeOff, Dumbbell
        } from 'https://esm.sh/lucide-react@0.292.0';

        const ICON_MAP = { 
            Calendar, CheckSquare, Target, Folder, BookOpen, Menu, Settings, Clock, 
            Dna, Microscope, Activity, Leaf, Zap, Globe, Database, Cpu, Layout, PenTool, Hash, Briefcase, Terminal,
            GraduationCap, Dumbbell
        };
        
        const BIO_DB = [
            {
                id: 1, name: "Cuervo Grande", scientific: "Corvus corax",
                taxonomy: { kingdom: "Animalia", phylum: "Chordata", class: "Aves", order: "Passeriformes", family: "Corvidae", genus: "Corvus" },
                desc: "Inteligencia comparable a primates. Capaz de usar herramientas.",
                fact: "Reconocen rostros humanos y guardan rencor.",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/a/aa/Corvus_corax_%28Common_Raven%29.jpg/800px-Corvus_corax_%28Common_Raven%29.jpg" 
            },
            {
                id: 2, name: "AraÃ±a Saltadora Audaz", scientific: "Phidippus audax",
                taxonomy: { kingdom: "Animalia", phylum: "Arthropoda", class: "Arachnida", order: "Araneae", family: "Salticidae", genus: "Phidippus" },
                desc: "Depredador visual con quelÃ­ceros iridiscentes.",
                fact: "Saltan 50 veces su longitud corporal.",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/Phidippus_audax_male.jpg/800px-Phidippus_audax_male.jpg"
            }
        ];

        const DEFAULT_TABS = [
            { id: 'tab1', label: 'EVENTOS', iconKey: 'Calendar', color: '#3b82f6' },
            { id: 'tab2', label: 'TAREAS', iconKey: 'CheckSquare', color: '#ef4444' },
            { id: 'tab3', label: 'NOTAS', iconKey: 'BookOpen', color: '#eab308' },
            { id: 'tab4', label: 'PROYECTOS', iconKey: 'Folder', color: '#22c55e' },
        ];

        const QUADRANTS = {
            q1: { id: 'q1', title: 'HACER YA', subtitle: 'Urgente + Importante', color: '#ef4444' },
            q2: { id: 'q2', title: 'PLANIFICAR', subtitle: 'No Urgente + Importante', color: '#3b82f6' },
            q3: { id: 'q3', title: 'DELEGAR', subtitle: 'Urgente + No Importante', color: '#eab308' },
            q4: { id: 'q4', title: 'ELIMINAR', subtitle: 'No Urgente + No Importante', color: '#64748b' }
        };

        const SCOPES = "https://www.googleapis.com/auth/calendar.readonly";
        const DISCOVERY_DOC = "https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest";

        function CommandCenterV7() {
            // --- STATES ---
            const [tabs, setTabs] = useState(DEFAULT_TABS);
            const [activeTabId, setActiveTabId] = useState('tab1');
            const [currentDate, setCurrentDate] = useState(new Date());
            const [events, setEvents] = useState([]); // Base de datos local + cachÃ©
            
            // UI
            const [modalMode, setModalMode] = useState(null); 
            const [selectedEventId, setSelectedEventId] = useState(null);
            const [eventFormData, setEventFormData] = useState({ title: '', date: '', time: '', type: 'general', notes: '', category: 'task', quadrant: 'q2' });
            const [showSettings, setShowSettings] = useState(false);

            // CALENDAR MANAGEMENT
            const [calendars, setCalendars] = useState({}); 
            // Control de cachÃ© para Lazy Loading: Set de strings "YYYY-MM" que ya se han descargado
            const fetchedMonths = useRef(new Set()); 

            // BIO
            const [bioIndex, setBioIndex] = useState(0); 
            const [showBioModal, setShowBioModal] = useState(false);

            // GOOGLE (GIS)
            const [isSyncing, setIsSyncing] = useState(false);
            const [googleConfig, setGoogleConfig] = useState({ apiKey: '', clientId: '' });
            const [isGoogleSignedIn, setIsGoogleSignedIn] = useState(false);
            
            const tokenClient = useRef(null);
            const gapiInited = useRef(false);
            const gisInited = useRef(false);

            // DRAWER
            const [drawerHeight, setDrawerHeight] = useState(40); 
            const [isDragging, setIsDragging] = useState(false);
            const dragStartY = useRef(0);
            const dragStartHeight = useRef(0);
            const [draggedEventId, setDraggedEventId] = useState(null);

            const activeTab = tabs.find(t => t.id === activeTabId) || tabs[0];
            const themeStyle = { '--theme-color': activeTab.color, '--theme-glow': `${activeTab.color}60` };
            const bioOrganism = BIO_DB[bioIndex];

            // --- INIT ---
            useEffect(() => {
                const savedEvents = localStorage.getItem('cmd_events_v7');
                const savedTabs = localStorage.getItem('cmd_tabs_v7');
                const savedConfig = localStorage.getItem('cmd_google_config');
                const savedCalendars = localStorage.getItem('cmd_calendars_meta');
                
                if (savedEvents) {
                    try { setEvents(JSON.parse(savedEvents)); } catch(e) { console.log("Reset events"); }
                } else {
                    setEvents([{ id: 1, title: 'INIT_SYSTEM_V7', date: new Date().toISOString().split('T')[0], time: '09:00', type: 'work', category: 'task', quadrant: 'q1' }]);
                }
                
                if (savedTabs) setTabs(JSON.parse(savedTabs));
                if (savedConfig) setGoogleConfig(JSON.parse(savedConfig));
                if (savedCalendars) setCalendars(JSON.parse(savedCalendars));

                if (window.gapi) window.gapi.load('client', initializeGapiClient);
            }, []);

            useEffect(() => { localStorage.setItem('cmd_events_v7', JSON.stringify(events)); }, [events]);
            useEffect(() => { localStorage.setItem('cmd_tabs_v7', JSON.stringify(tabs)); }, [tabs]);
            useEffect(() => { localStorage.setItem('cmd_google_config', JSON.stringify(googleConfig)); }, [googleConfig]);
            useEffect(() => { localStorage.setItem('cmd_calendars_meta', JSON.stringify(calendars)); }, [calendars]);

            // --- LAZY LOADING TRIGGER ---
            // Detecta cambio de mes y pide datos si no existen
            useEffect(() => {
                if (isGoogleSignedIn && googleConfig.apiKey) {
                    const year = currentDate.getFullYear();
                    const month = currentDate.getMonth();
                    const key = `${year}-${month}`; // Key actual
                    
                    // TambiÃ©n verificamos el mes siguiente para precarga (UX mÃ¡s suave)
                    const nextMonthDate = new Date(year, month + 1, 1);
                    const nextKey = `${nextMonthDate.getFullYear()}-${nextMonthDate.getMonth()}`;

                    // Si no hemos descargado este mes O el siguiente, ejecutamos sync parcial
                    if (!fetchedMonths.current.has(key) || !fetchedMonths.current.has(nextKey)) {
                        console.log(`ðŸ“… Lazy Load: Fetching ${key} & ${nextKey}`);
                        fetchGoogleEvents(currentDate);
                    }
                }
            }, [currentDate, isGoogleSignedIn]);

            // --- GOOGLE INTEGRATION ---
            const initializeGapiClient = async () => {
                if (!googleConfig.apiKey) return;
                try {
                    await window.gapi.client.init({ apiKey: googleConfig.apiKey, discoveryDocs: [DISCOVERY_DOC] });
                    gapiInited.current = true;
                } catch (err) { console.error("GAPI Init Error:", err); }
            };

            const initializeGisClient = () => {
                if (!googleConfig.clientId) return;
                try {
                    tokenClient.current = window.google.accounts.oauth2.initTokenClient({
                        client_id: googleConfig.clientId,
                        scope: SCOPES,
                        callback: async (resp) => {
                            if (resp.error) { alert("Error Auth: " + JSON.stringify(resp)); return; }
                            setIsGoogleSignedIn(true);
                            // Al loguearse, forzamos carga del mes actual
                            fetchedMonths.current.clear(); 
                            await fetchGoogleEvents(currentDate);
                        },
                    });
                    gisInited.current = true;
                } catch (err) { console.error("GIS Init Error:", err); }
            };

            const handleAuthClick = async () => {
                if (!googleConfig.apiKey || !googleConfig.clientId) { alert("âš ï¸ FALTAN DATOS: Configura API Key y Client ID."); return; }
                if (!gapiInited.current) await initializeGapiClient();
                if (!gisInited.current) initializeGisClient();

                setTimeout(() => {
                    if (tokenClient.current) tokenClient.current.requestAccessToken({ prompt: 'consent' });
                    else { initializeGisClient(); if(tokenClient.current) tokenClient.current.requestAccessToken({ prompt: 'consent' }); }
                }, 500);
            };

            const handleSignOutClick = () => {
                const token = window.gapi.client.getToken();
                if (token !== null) {
                    window.google.accounts.oauth2.revoke(token.access_token);
                    window.gapi.client.setToken('');
                    setIsGoogleSignedIn(false);
                    setEvents(prev => prev.filter(e => e.type !== 'google'));
                    fetchedMonths.current.clear();
                }
            };

            // --- OPTIMIZED FETCH (LAZY LOADING) ---
            const fetchGoogleEvents = async (targetDate = new Date()) => {
                setIsSyncing(true);
                try {
                    if (!window.gapi.client.calendar) {
                        await window.gapi.client.load('calendar', 'v3');
                    }

                    // 1. Definir Rango de Tiempo (Mes actual - 1 semana hasta Mes siguiente + 1 semana)
                    // Esto evita cargar "el infinito" de eventos recurrentes.
                    const year = targetDate.getFullYear();
                    const month = targetDate.getMonth();
                    
                    const timeMin = new Date(year, month - 1, 1).toISOString(); // Un mes atrÃ¡s por seguridad
                    const timeMax = new Date(year, month + 2, 0).toISOString(); // Hasta final del mes siguiente
                    
                    // Marcar estos meses como "Visitados/Cargados" en RAM
                    fetchedMonths.current.add(`${year}-${month}`);
                    fetchedMonths.current.add(`${year}-${month+1}`);

                    const calendarListResponse = await window.gapi.client.calendar.calendarList.list();
                    const rawCalendars = calendarListResponse.result.items;

                    // Actualizar metadatos de calendarios
                    const updatedCalendars = { ...calendars };
                    rawCalendars.forEach(cal => {
                        if (!updatedCalendars[cal.id]) {
                            updatedCalendars[cal.id] = { id: cal.id, summary: cal.summary, color: cal.backgroundColor, visible: true };
                        } else {
                            updatedCalendars[cal.id].summary = cal.summary;
                            updatedCalendars[cal.id].color = cal.backgroundColor;
                        }
                    });
                    setCalendars(updatedCalendars);

                    // 2. Fetch Paralelo por Calendario con Rango de Tiempo
                    let allFetchedEvents = [];
                    const promises = rawCalendars.map(async (cal) => {
                        if (calendars[cal.id] && !calendars[cal.id].visible) return []; // Skip invisible calendars fetch optimization
                        try {
                            const response = await window.gapi.client.calendar.events.list({
                                'calendarId': cal.id,
                                'timeMin': timeMin, // CLAVE DE OPTIMIZACIÃ“N
                                'timeMax': timeMax, // CLAVE DE OPTIMIZACIÃ“N
                                'showDeleted': false,
                                'singleEvents': true, // Expande recurrencias solo en este rango
                                'maxResults': 2500, // Alto lÃ­mite, pero acotado por fecha
                                'orderBy': 'startTime',
                            });

                            return response.result.items.map(item => {
                                const calName = (cal.summary || '').toLowerCase();
                                const title = (item.summary || '').toLowerCase();
                                const desc = (item.description || '').toLowerCase();
                                
                                let category = 'task';
                                let quadrant = 'q2';
                                
                                // CategorizaciÃ³n AutomÃ¡tica
                                if (calName.includes('fitness') || calName.includes('gym') || calName.includes('rutina') || calName.includes('entreno') || title.includes('gym')) {
                                    category = 'fitness'; quadrant = null;
                                } else if (calName.includes('clase') || calName.includes('uni') || calName.includes('horario') || title.includes('clase') || desc.includes('profesor')) {
                                    category = 'class'; quadrant = null;
                                }

                                return {
                                    id: item.id,
                                    calendarId: cal.id, 
                                    title: item.summary || '(Sin tÃ­tulo)',
                                    date: item.start.dateTime ? item.start.dateTime.split('T')[0] : (item.start.date || ''),
                                    time: item.start.dateTime ? item.start.dateTime.split('T')[1].substring(0,5) : '',
                                    type: 'google',
                                    notes: item.description || '',
                                    category: category, 
                                    quadrant: quadrant,
                                    googleColor: cal.backgroundColor 
                                };
                            });
                        } catch (err) { console.warn(`Skip Cal: ${cal.summary}`); return []; }
                    });

                    const results = await Promise.all(promises);
                    allFetchedEvents = results.flat();

                    // 3. MERGE INTELIGENTE (No borrar todo, solo actualizar lo nuevo/modificado)
                    setEvents(prevEvents => {
                        const localEvents = prevEvents.filter(e => e.type !== 'google');
                        const googleEventsOld = prevEvents.filter(e => e.type === 'google');
                        
                        // Crear un mapa de los nuevos eventos para acceso rÃ¡pido
                        const newEventsMap = new Map(allFetchedEvents.map(e => [e.id, e]));
                        
                        // Filtrar los viejos: Si un evento viejo estÃ¡ en el rango de tiempo que acabamos de pedir,
                        // pero NO estÃ¡ en la nueva respuesta, significa que fue borrado en Google -> Lo quitamos.
                        // Si estÃ¡ fuera del rango de tiempo actual, lo conservamos (cache).
                        const keptGoogleEvents = googleEventsOld.filter(oldEv => {
                            const inFetchRange = oldEv.date >= timeMin.split('T')[0] && oldEv.date <= timeMax.split('T')[0];
                            if (inFetchRange) return newEventsMap.has(oldEv.id); // Solo mantener si sigue existiendo
                            return true; // Mantener cachÃ© de otros meses
                        });

                        // Unir: Locales + Google Antiguos (filtrados) + Nuevos de Google (Actualizados)
                        // Para evitar duplicados en el merge final usamos un Map por ID
                        const finalMap = new Map();
                        localEvents.forEach(e => finalMap.set(e.id, e));
                        keptGoogleEvents.forEach(e => finalMap.set(e.id, e)); // Estos pueden ser sobrescritos por los nuevos abajo
                        allFetchedEvents.forEach(e => finalMap.set(e.id, e)); // Los nuevos ganan prioridad (actualizaciÃ³n)

                        return Array.from(finalMap.values());
                    });

                    console.log(`âœ… SYNC COMPLETE. Range: ${timeMin.slice(0,10)} to ${timeMax.slice(0,10)}`);

                } catch (err) {
                    console.error(err);
                } finally { setIsSyncing(false); }
            };

            const toggleCalendarVisibility = (calId) => {
                setCalendars(prev => ({
                    ...prev,
                    [calId]: { ...prev[calId], visible: !prev[calId].visible }
                }));
            };

            // --- HELPER LOGIC ---
            const days = useMemo(() => {
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const d = [];
                const startPadding = firstDay.getDay() === 0 ? 6 : firstDay.getDay() - 1; 
                for (let i = 0; i < startPadding; i++) d.push({ day: '', date: null, isPadding: true });
                for (let i = 1; i <= lastDay.getDate(); i++) {
                    d.push({ day: i, date: new Date(year, month, i).toISOString().split('T')[0], isPadding: false });
                }
                return d;
            }, [currentDate]);

            // --- OPTIMIZACIÃ“N CRÃTICA: INDEXADO O(1) ---
            // En lugar de filtrar el array gigante en cada celda, creamos un mapa indexado por fecha.
            const { eventLookup, matrixEvents, upcomingEventsForDrawer } = useMemo(() => {
                const lookup = {};
                const matrix = [];
                const todayStr = new Date().toISOString().split('T')[0];
                const upcoming = [];

                events.forEach(ev => {
                    // Filtro de Visibilidad Global
                    if (ev.type === 'google' && ev.calendarId && calendars[ev.calendarId] && calendars[ev.calendarId].visible === false) return;

                    // 1. Llenar Lookup para Calendario (Hash Map)
                    if (ev.date) {
                        if (!lookup[ev.date]) lookup[ev.date] = [];
                        lookup[ev.date].push(ev);
                    }

                    // 2. Llenar Matriz (Solo tareas)
                    if (ev.category !== 'class' && ev.category !== 'fitness') {
                        matrix.push(ev);
                    }

                    // 3. Preparar Drawer (Solo futuros o hoy, limite 100 para evitar lag)
                    if (ev.date >= todayStr) {
                        upcoming.push(ev);
                    }
                });

                // Ordenar Drawer y cortar para performance
                upcoming.sort((a, b) => {
                    if (a.date !== b.date) return a.date.localeCompare(b.date);
                    return (a.time || '00:00').localeCompare(b.time || '00:00');
                });
                
                // Ordenar eventos dentro de cada dÃ­a del lookup para visualizaciÃ³n correcta
                Object.keys(lookup).forEach(key => {
                     lookup[key].sort((a, b) => (a.time || '00:00').localeCompare(b.time || '00:00'));
                });

                return { 
                    eventLookup: lookup, 
                    matrixEvents: matrix,
                    upcomingEventsForDrawer: upcoming.slice(0, 60) // Hard Limit: Solo mostrar 60 prÃ³ximos eventos en drawer
                };
            }, [events, calendars]); // Solo recalcula si cambian eventos o visibilidad

            const handleWidgetClick = () => {
                let newIndex = BIO_DB.length > 1 ? Math.floor(Math.random() * BIO_DB.length) : 0;
                setBioIndex(newIndex);
                setShowBioModal(true);
            };

            // --- DRAG ---
            const handleDragStart = (e, eventId) => { setDraggedEventId(eventId); e.dataTransfer.effectAllowed = "move"; };
            const handleDragOver = (e) => { e.preventDefault(); e.currentTarget.classList.add('drag-over'); };
            const handleDragLeave = (e) => { e.currentTarget.classList.remove('drag-over'); };
            const handleDrop = (e, targetQuadrantId) => {
                e.preventDefault(); e.currentTarget.classList.remove('drag-over');
                if (!draggedEventId) return;
                setEvents(prev => prev.map(ev => ev.id === draggedEventId ? { ...ev, quadrant: targetQuadrantId } : ev));
                setDraggedEventId(null);
            };

            // --- DRAWER ---
            const handleTouchStart = (e) => { setIsDragging(true); dragStartY.current = e.touches[0].clientY; dragStartHeight.current = drawerHeight; };
            const handleTouchMove = (e) => {
                if (!isDragging) return;
                const deltaY = dragStartY.current - e.touches[0].clientY; 
                const newHeight = Math.min(window.innerHeight - 50, Math.max(40, dragStartHeight.current + deltaY));
                setDrawerHeight(newHeight);
            };
            const handleTouchEnd = () => {
                setIsDragging(false); const screenH = window.innerHeight;
                if (drawerHeight > screenH * 0.75) setDrawerHeight(screenH - 20);
                else if (drawerHeight > screenH * 0.3) setDrawerHeight(screenH * 0.5);
                else setDrawerHeight(40);
            };

            // AgrupaciÃ³n para el Drawer (Usando la lista optimizada)
            const eventsByDate = useMemo(() => {
                const grouped = {};
                upcomingEventsForDrawer.forEach(ev => { 
                    if (!grouped[ev.date]) grouped[ev.date] = []; 
                    grouped[ev.date].push(ev); 
                });
                return Object.keys(grouped).map(date => ({ date, items: grouped[date] }));
            }, [upcomingEventsForDrawer]);

            // --- RENDER ---
            return React.createElement('div', { 
                className: "h-screen w-screen bg-black text-slate-200 font-sans overflow-hidden flex flex-col relative",
                style: themeStyle
            }, [
                // BG
                React.createElement('div', { className: "absolute inset-0 pointer-events-none" }, 
                    React.createElement('div', { className: "absolute inset-0 opacity-10", style: { backgroundImage: `radial-gradient(circle at 50% 0%, var(--theme-color), transparent 80%)` } }),
                    React.createElement('div', { className: "absolute inset-0 opacity-20", style: { backgroundImage: `linear-gradient(#222 1px, transparent 1px), linear-gradient(90deg, #222 1px, transparent 1px)`, backgroundSize: '40px 40px' } })
                ),

                // 1. HEADER
                React.createElement('header', { className: "relative z-20 flex flex-col pt-2 bg-black/90 border-b border-white/10 shrink-0" }, 
                    React.createElement('div', { className: "flex overflow-x-auto no-scrollbar px-4 gap-2" }, 
                        tabs.map(tab => {
                            const Icon = ICON_MAP[tab.iconKey] || Menu;
                            const isActive = activeTabId === tab.id;
                            return React.createElement('button', {
                                key: tab.id, onClick: () => setActiveTabId(tab.id),
                                style: { borderColor: isActive ? tab.color : 'transparent', color: isActive ? tab.color : '#525252', backgroundColor: isActive ? `${tab.color}10` : 'transparent' },
                                className: "flex items-center gap-2 px-6 py-4 rounded-t-lg text-sm font-black tracking-widest transition-all duration-300 border-b-4 hover:bg-white/5 uppercase shrink-0"
                            }, [React.createElement(Icon, { size: 18, strokeWidth: 2.5 }), tab.label])
                        })
                    )
                ),

                // 2. MAIN
                React.createElement('main', { className: "flex-1 px-2 pb-2 md:px-6 md:pb-8 overflow-hidden flex flex-col relative z-10" }, 
                    React.createElement('div', { className: "py-4 flex flex-row items-center justify-between shrink-0" }, [
                        React.createElement('div', { className: "flex flex-col md:flex-row md:items-baseline gap-2" }, [
                            activeTabId === 'tab2' 
                                ? React.createElement('h1', { className: "text-4xl md:text-5xl font-black text-white tracking-tighter m-0 leading-none" }, "MATRIZ TÃCTICA")
                                : React.createElement('h1', { className: "text-4xl md:text-5xl font-black text-white tracking-tighter m-0 leading-none" }, currentDate.toLocaleString('es-ES', { month: 'long' }).toUpperCase()),
                            activeTabId === 'tab1' && React.createElement('span', { className: "text-neutral-500 font-bold text-2xl" }, currentDate.getFullYear())
                        ]),
                        React.createElement('div', { className: "flex items-center gap-3" }, [
                            activeTabId === 'tab1' && React.createElement('div', { className: "hidden md:flex items-center bg-neutral-900 border border-neutral-800 rounded-lg p-1 mr-2" }, [
                                React.createElement('button', { onClick: () => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1)), className: "p-2 text-neutral-400 hover:text-white" }, React.createElement(ChevronLeft, { size: 20 })),
                                React.createElement('button', { onClick: () => setCurrentDate(new Date()), className: "px-2 text-xs font-bold text-neutral-400 hover:text-white" }, "HOY"),
                                React.createElement('button', { onClick: () => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1)), className: "p-2 text-neutral-400 hover:text-white" }, React.createElement(ChevronRight, { size: 20 }))
                            ]),
                            
                            // BotÃ³n de Sync
                            React.createElement('button', { 
                                onClick: isGoogleSignedIn ? () => fetchGoogleEvents(currentDate) : handleAuthClick,
                                className: `flex items-center gap-2 px-3 py-2 rounded-lg border bg-neutral-900 active:scale-95 transition-all ${isSyncing ? 'border-[var(--theme-color)] text-[var(--theme-color)]' : 'border-neutral-800 text-neutral-400'}`
                            }, [React.createElement(RefreshCw, { size: 18, className: isSyncing ? 'animate-spin' : '' }), React.createElement('span', { className: "hidden md:inline text-[10px] font-black" }, "SYNC")]),
                            
                            React.createElement('button', { onClick: () => setShowSettings(true), className: "p-2.5 rounded-lg bg-neutral-900 border border-neutral-800 text-neutral-400 hover:text-white hover:border-white transition-colors" }, React.createElement(Settings, { size: 20 }))
                        ])
                    ]),

                    // VISTA TAB 2: MATRIZ DE TAREAS
                    activeTabId === 'tab2' 
                    ? React.createElement('div', { className: "flex-1 overflow-hidden grid grid-cols-1 md:grid-cols-2 grid-rows-2 gap-2 md:gap-4 pb-20 md:pb-0" }, 
                        ['q1', 'q2', 'q3', 'q4'].map(qKey => {
                            const qData = QUADRANTS[qKey];
                            const qEvents = matrixEvents.filter(e => (e.quadrant || 'q2') === qKey);
                            return React.createElement('div', { 
                                key: qKey, onDragOver: handleDragOver, onDragLeave: handleDragLeave, onDrop: (e) => handleDrop(e, qKey),
                                className: "droppable-area bg-neutral-900/40 border border-neutral-800/60 rounded-xl p-3 flex flex-col relative overflow-hidden backdrop-blur-sm"
                            }, [
                                React.createElement('div', { className: "flex justify-between items-center mb-3 pb-2 border-b border-white/5" }, [
                                    React.createElement('div', { className: "flex flex-col" }, [
                                        React.createElement('h3', { className: "text-sm font-black tracking-widest", style: { color: qData.color } }, qData.title),
                                        React.createElement('span', { className: "text-[9px] text-neutral-500 font-mono uppercase" }, qData.subtitle)
                                    ]),
                                    React.createElement('span', { className: "bg-neutral-800 text-neutral-400 text-[10px] font-bold px-2 py-0.5 rounded-full" }, qEvents.length)
                                ]),
                                React.createElement('div', { className: "flex-1 overflow-y-auto space-y-2 no-scrollbar" }, 
                                    qEvents.map(ev => React.createElement('div', {
                                        key: ev.id, draggable: true, onDragStart: (e) => handleDragStart(e, ev.id),
                                        onClick: () => { setEventFormData({ ...ev }); setSelectedEventId(ev.id); setModalMode('edit'); },
                                        className: "draggable-item bg-black/60 border border-neutral-800 hover:border-white/30 p-2.5 rounded-lg group transition-all active:scale-95"
                                    }, [
                                        React.createElement('div', { className: "flex items-start gap-2" }, [
                                            React.createElement('div', { className: "mt-0.5 text-emerald-400" }, React.createElement(CheckCircle, { size: 14 })),
                                            React.createElement('div', { className: "flex-1 min-w-0" }, [
                                                React.createElement('p', { 
                                                    className: "text-xs font-bold text-white truncate leading-tight rich-text",
                                                    dangerouslySetInnerHTML: { __html: ev.title }
                                                }),
                                                React.createElement('div', { className: "flex items-center gap-2 mt-1" }, [
                                                    ev.time && React.createElement('span', { className: "text-[9px] text-neutral-500 font-mono bg-neutral-900 px-1 rounded" }, ev.time),
                                                    ev.date && React.createElement('span', { className: "text-[9px] text-neutral-600 font-mono" }, ev.date.substring(5))
                                                ])
                                            ]),
                                            React.createElement(GripHorizontal, { size: 14, className: "text-neutral-700 group-hover:text-neutral-500" })
                                        ])
                                    ]))
                                )
                            ])
                        })
                      )
                    // VISTA TAB 1: CALENDARIO (OPTIMIZADO CON LOOKUP)
                    : React.createElement('div', { className: "flex-1 bg-neutral-900/30 backdrop-blur-sm rounded-xl border border-neutral-800 overflow-hidden flex flex-col relative shadow-[0_0_100px_rgba(0,0,0,0.5)]" }, [
                        React.createElement('div', { className: "grid grid-cols-7 bg-black border-b border-neutral-800" }, 
                            ['LUN', 'MAR', 'MIÃ‰', 'JUE', 'VIE', 'SÃB', 'DOM'].map(day => React.createElement('div', { key: day, className: "py-2 text-center text-[10px] md:text-xs font-black tracking-[0.2em] text-neutral-600" }, day))
                        ),
                        React.createElement('div', { className: "grid grid-cols-7 flex-1 auto-rows-fr" }, 
                            days.map((dayObj, index) => {
                                if (dayObj.isPadding) return React.createElement('div', { key: index, className: "border-r border-b border-neutral-800/40 bg-neutral-950/40" });
                                
                                // OJO: AQUÃ ESTÃ LA MAGIA DE LA VELOCIDAD. BÃºsqueda directa O(1) en lugar de filtrar.
                                const dayEvents = dayObj.date ? (eventLookup[dayObj.date] || []) : [];
                                
                                const isToday = dayObj.date === new Date().toISOString().split('T')[0];
                                return React.createElement('div', {
                                    key: index,
                                    onClick: () => { setEventFormData({ title: '', date: dayObj.date, time: '09:00', type: 'general', notes: '', category: 'task', quadrant: 'q2' }); setModalMode('create'); },
                                    className: `relative border-r border-b border-neutral-800/40 p-1 md:p-2 transition-colors cursor-pointer group hover:bg-neutral-900 ${isToday ? 'bg-neutral-900/80' : ''}`
                                }, [
                                    React.createElement('span', { className: `text-xs font-bold flex items-center justify-center w-6 h-6 rounded ${isToday ? 'bg-[var(--theme-color)] text-black' : 'text-neutral-600 group-hover:text-white'}` }, dayObj.day),
                                    React.createElement('div', { className: "mt-1 flex flex-col gap-1 overflow-y-auto max-h-[80px] no-scrollbar" }, 
                                        dayEvents.map(event => {
                                            const eventColor = event.googleColor || activeTab.color;
                                            return React.createElement('div', {
                                                key: event.id,
                                                onClick: (e) => { e.stopPropagation(); setEventFormData({ ...event }); setSelectedEventId(event.id); setModalMode('edit'); },
                                                className: `text-[9px] md:text-[10px] font-bold truncate px-1.5 py-0.5 rounded border-l-[3px] hover:brightness-125 transition-transform`,
                                                style: { 
                                                    borderLeftColor: eventColor,
                                                    backgroundColor: `${eventColor}20`,
                                                    color: '#e2e8f0' 
                                                }
                                            }, [
                                                event.category === 'class' && React.createElement(GraduationCap, { size: 8, className: "inline mr-1" }),
                                                event.category === 'fitness' && React.createElement(Dumbbell, { size: 8, className: "inline mr-1" }),
                                                React.createElement('span', { 
                                                    className: "rich-text",
                                                    dangerouslySetInnerHTML: { __html: event.time ? `${event.time} ${event.title}` : event.title } 
                                                })
                                            ]);
                                        })
                                    )
                                ])
                            })
                        )
                    ])
                ),

                // 3. DRAWER (OPTIMIZADO)
                React.createElement('div', { 
                    className: `fixed bottom-0 left-0 right-[60px] z-50 rounded-tr-2xl glass-panel flex flex-col ${!isDragging ? 'drawer-transition' : ''}`, 
                    style: { height: `${drawerHeight}px` }
                }, [
                    React.createElement('div', { 
                        className: "w-full h-8 flex items-center justify-center cursor-grab active:cursor-grabbing shrink-0 touch-none",
                        onTouchStart: handleTouchStart, onTouchMove: handleTouchMove, onTouchEnd: handleTouchEnd
                    }, React.createElement('div', { className: "w-16 h-1 bg-white/30 rounded-full" })),
                    
                    React.createElement('div', { className: "flex-1 overflow-x-auto p-4 flex gap-4 no-scrollbar" }, 
                        eventsByDate.length > 0 ? eventsByDate.map(group => React.createElement('div', { key: group.date, className: "min-w-[220px] w-[220px] flex flex-col gap-2 opacity-90" }, [
                            React.createElement('div', { className: "text-[10px] font-black text-[var(--theme-color)] uppercase tracking-widest border-b border-white/10 pb-1 mb-2" }, 
                                new Date(group.date).toLocaleDateString('es-ES', { weekday: 'short', day: 'numeric', month: 'short' })
                            ),
                            group.items.map(ev => {
                                const evColor = ev.googleColor || '#ffffff';
                                return React.createElement('div', { 
                                    key: ev.id,
                                    onClick: (e) => { setEventFormData({ ...ev }); setSelectedEventId(ev.id); setModalMode('edit'); },
                                    className: "bg-black/40 border-l-4 p-3 rounded hover:brightness-125 transition-colors cursor-pointer backdrop-blur-sm",
                                    style: { borderLeftColor: evColor }
                                }, [
                                    React.createElement('div', { className: "flex justify-between items-start mb-1" }, [
                                        React.createElement('span', { className: "text-xs font-bold text-white truncate flex items-center gap-1" }, [
                                            ev.category === 'class' && React.createElement(GraduationCap, { size: 10, style: { color: evColor } }),
                                            ev.category === 'fitness' && React.createElement(Dumbbell, { size: 10, style: { color: evColor } }),
                                            React.createElement('span', { className: "rich-text", dangerouslySetInnerHTML: { __html: ev.title } })
                                        ]),
                                        React.createElement('span', { className: "text-[9px] text-neutral-400 font-mono" }, ev.time)
                                    ]),
                                    ev.notes && React.createElement('div', { 
                                        className: "text-[9px] text-neutral-500 line-clamp-2 italic rich-text",
                                        dangerouslySetInnerHTML: { __html: ev.notes }
                                    })
                                ]);
                            })
                        ])) : React.createElement('div', { className: "flex items-center justify-center w-full text-neutral-500 text-xs italic" }, "No hay eventos prÃ³ximos (mostrando 60 dÃ­as)")
                    )
                ]),

                // 4. BIO
                React.createElement('div', {
                    onClick: handleWidgetClick,
                    className: `fixed bottom-0 right-0 w-32 z-[60] flex items-center justify-center cursor-pointer hover:bg-black/50 active:scale-95 overflow-hidden rounded-tl-[30px] group shadow-[0_0_30px_rgba(0,0,0,0.8)] backdrop-blur-md ${!isDragging ? 'drawer-transition' : ''}`, 
                    style: { 
                        height: `${drawerHeight}px`, backgroundColor: 'rgba(0, 0, 0, 0.4)', 
                        borderLeft: `2px solid ${activeTab.color}`, borderTop: `2px solid ${activeTab.color}`,
                        boxShadow: `0 0 20px ${activeTab.color}40, inset 0 0 10px ${activeTab.color}10`
                    } 
                }, [
                    React.createElement(Dna, { size: 28, className: "group-hover:animate-spin transition-transform duration-700", style: { color: activeTab.color } }),
                    React.createElement('div', { className: "absolute inset-0 bg-gradient-to-tr from-transparent to-white/10 pointer-events-none" })
                ]),

                // 5. SETTINGS
                showSettings && React.createElement('div', { className: "fixed inset-0 z-[60] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-in fade-in" }, 
                    React.createElement('div', { className: "w-full max-w-2xl h-[80vh] bg-neutral-900 border border-neutral-700 rounded-2xl overflow-hidden shadow-2xl flex flex-col" }, [
                        React.createElement('div', { className: "p-4 bg-black flex justify-between items-center border-b border-neutral-800" }, [
                            React.createElement('h3', { className: "font-bold text-white flex gap-2" }, [React.createElement(Settings, { size: 18 }), "CONFIGURACIÃ“N"]),
                            React.createElement('button', { onClick: () => setShowSettings(false) }, React.createElement(X))
                        ]),
                        React.createElement('div', { className: "flex-1 overflow-y-auto p-6 space-y-6" }, [
                            Object.keys(calendars).length > 0 && React.createElement('div', { className: "space-y-4" }, [
                                React.createElement('h4', { className: "text-xs font-bold text-neutral-500 uppercase tracking-widest border-b border-neutral-800 pb-2" }, "Calendarios Detectados"),
                                React.createElement('div', { className: "space-y-2" }, 
                                    Object.values(calendars).map(cal => React.createElement('div', { key: cal.id, className: "flex items-center justify-between p-3 bg-black/50 border border-neutral-800 rounded-lg" }, [
                                        React.createElement('div', { className: "flex items-center gap-3" }, [
                                            React.createElement('div', { className: "w-3 h-3 rounded-full", style: { backgroundColor: cal.color } }),
                                            React.createElement('span', { className: "text-sm font-bold text-white" }, cal.summary)
                                        ]),
                                        React.createElement('button', { onClick: () => toggleCalendarVisibility(cal.id), className: `p-2 rounded hover:bg-white/10 ${cal.visible ? 'text-green-400' : 'text-neutral-600'}` }, 
                                            cal.visible ? React.createElement(Eye, { size: 18 }) : React.createElement(EyeOff, { size: 18 })
                                        )
                                    ]))
                                )
                            ]),
                            React.createElement('div', { className: "space-y-4" }, [
                                React.createElement('h4', { className: "text-xs font-bold text-neutral-500 uppercase tracking-widest border-b border-neutral-800 pb-2" }, "Estilo UI"),
                                React.createElement('div', { className: "space-y-3" }, tabs.map(tab => React.createElement('div', { key: tab.id, className: "bg-black border border-neutral-800 p-3 rounded-lg flex items-center gap-4" }, [
                                    React.createElement('input', { type: "color", value: tab.color, onChange: (e) => setTabs(tabs.map(t => t.id === tab.id ? {...t, color: e.target.value} : t)), className: "w-8 h-8 cursor-pointer rounded bg-transparent" }),
                                    React.createElement('input', { className: "bg-transparent text-white font-bold text-sm w-full outline-none", value: tab.label, onChange: (e) => setTabs(tabs.map(t => t.id === tab.id ? {...t, label: e.target.value} : t)) })
                                ])))
                            ]),
                            React.createElement('div', { className: "space-y-2 pt-4" }, [
                                React.createElement('h4', { className: "text-xs font-bold text-neutral-500 uppercase tracking-widest border-b border-neutral-800 pb-2" }, "Google API (GIS V2)"),
                                React.createElement('div', { className: "p-3 bg-black/50 rounded border border-neutral-800 space-y-2" }, [
                                    React.createElement('input', { type: "password", placeholder: "Client ID", className: "w-full bg-transparent border-b border-neutral-700 text-xs p-1 text-white outline-none", value: googleConfig.clientId, onChange: (e) => setGoogleConfig({...googleConfig, clientId: e.target.value}) }),
                                    React.createElement('input', { type: "password", placeholder: "API Key", className: "w-full bg-transparent border-b border-neutral-700 text-xs p-1 text-white outline-none", value: googleConfig.apiKey, onChange: (e) => setGoogleConfig({...googleConfig, apiKey: e.target.value}) }),
                                    React.createElement('button', { onClick: isGoogleSignedIn ? handleSignOutClick : handleAuthClick, className: `w-full py-2 mt-2 rounded text-xs font-bold ${isGoogleSignedIn ? 'bg-red-900/30 text-red-400' : 'bg-blue-900/30 text-blue-400'}` }, isGoogleSignedIn ? "DESCONECTAR" : "CONECTAR Y SINCRONIZAR")
                                ])
                            ])
                        ])
                    ])
                ),

                // 6. MODAL FORM
                modalMode && React.createElement('div', { className: "fixed inset-0 z-[70] flex items-center justify-center bg-black/90 backdrop-blur-md p-4 animate-in fade-in" }, 
                    React.createElement('div', { className: "w-full max-w-md bg-neutral-900 border border-neutral-700 rounded-2xl overflow-hidden shadow-2xl flex flex-col max-h-[90vh]" }, [
                        React.createElement('div', { className: "p-4 bg-black flex justify-between items-center border-b border-neutral-800 shrink-0" }, [
                            React.createElement('span', { className: "font-bold text-white text-sm tracking-wider flex items-center gap-2" }, [
                                modalMode === 'edit' ? React.createElement(Edit3, { size: 16 }) : React.createElement(Plus, { size: 16 }),
                                modalMode === 'edit' ? "EDITAR" : "NUEVO"
                            ]),
                            React.createElement('button', { onClick: () => setModalMode(null) }, React.createElement(X, { size: 20 }))
                        ]),
                        React.createElement('div', { className: "p-5 space-y-4 overflow-y-auto" }, [
                            React.createElement('div', { className: "flex gap-2 mb-2" }, 
                                [ { id: 'task', label: 'TAREA', icon: CheckSquare }, { id: 'class', label: 'CLASE', icon: GraduationCap }, { id: 'fitness', label: 'FITNESS', icon: Dumbbell } ].map(cat => 
                                React.createElement('button', { key: cat.id, onClick: () => setEventFormData({...eventFormData, category: cat.id}), className: `flex-1 py-2 rounded border text-[10px] md:text-xs font-black ${eventFormData.category === cat.id ? 'bg-[var(--theme-color)] text-black' : 'text-neutral-500 border-neutral-700'}` }, [React.createElement(cat.icon, { size: 14, className: "inline mr-1" }), cat.label])
                            )),
                            React.createElement('input', { autoFocus: true, type: "text", placeholder: "TÃ­tulo...", className: "w-full bg-black border border-neutral-700 rounded p-3 text-white font-bold outline-none", value: eventFormData.title, onChange: (e) => setEventFormData({...eventFormData, title: e.target.value}) }),
                            (eventFormData.category !== 'class' && eventFormData.category !== 'fitness') && React.createElement('div', { className: "grid grid-cols-2 gap-2" }, Object.values(QUADRANTS).map(q => React.createElement('button', { key: q.id, onClick: () => setEventFormData({...eventFormData, quadrant: q.id}), className: `p-2 rounded border text-[10px] font-bold uppercase ${eventFormData.quadrant === q.id ? 'bg-white/10 text-white' : 'text-neutral-600 border-neutral-800'}` }, q.title))),
                            React.createElement('div', { className: "grid grid-cols-2 gap-3" }, [
                                React.createElement('input', { type: "date", className: "w-full bg-black border border-neutral-700 rounded p-2 text-sm text-white", value: eventFormData.date, onChange: (e) => setEventFormData({...eventFormData, date: e.target.value}) }),
                                React.createElement('input', { type: "time", className: "w-full bg-black border border-neutral-700 rounded p-2 text-sm text-white", value: eventFormData.time, onChange: (e) => setEventFormData({...eventFormData, time: e.target.value}) }),
                            ]),
                            React.createElement('textarea', { rows: 4, className: "w-full bg-black border border-neutral-700 rounded p-3 text-sm text-neutral-300 outline-none resize-none", placeholder: "Notas...", value: eventFormData.notes, onChange: (e) => setEventFormData({...eventFormData, notes: e.target.value}) }),
                            React.createElement('div', { className: "pt-2 flex gap-3" }, [
                                modalMode === 'edit' && React.createElement('button', { onClick: () => { setEvents(events.filter(ev => ev.id !== selectedEventId)); setModalMode(null); }, className: "p-3 rounded bg-red-900/20 text-red-500 border border-red-900" }, React.createElement(Trash2, { size: 18 })),
                                React.createElement('button', { onClick: () => { if (!eventFormData.title) return; if (modalMode === 'create') setEvents([...events, { id: Date.now(), ...eventFormData }]); else setEvents(events.map(ev => ev.id === selectedEventId ? { ...ev, ...eventFormData } : ev)); setModalMode(null); }, className: "flex-1 py-3 rounded bg-[var(--theme-color)] text-black font-black uppercase" }, "CONFIRMAR")
                            ])
                        ])
                    ])
                ),

                // 7. BIO MODAL
                showBioModal && bioOrganism && React.createElement('div', { className: "fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in" }, 
                    React.createElement('div', { className: "w-full max-w-3xl rounded-lg overflow-hidden flex flex-col md:flex-row relative shadow-2xl", style: { backgroundColor: 'rgba(10, 10, 10, 0.8)', borderColor: activeTab.color, borderWidth: '1px' } }, [
                        React.createElement('button', { onClick: () => setShowBioModal(false), style: { color: activeTab.color }, className: "absolute top-4 right-4 z-50 p-2 rounded-full hover:brightness-125" }, React.createElement(X)),
                        React.createElement('div', { className: "w-full md:w-1/2 h-64 md:h-auto relative bio-scan overflow-hidden bg-black" }, [
                            React.createElement('img', { src: bioOrganism.img, className: "w-full h-full object-cover opacity-80", onError: (e) => { e.target.src = "https://images.unsplash.com/photo-1530026405186-ed1f139313f8?auto=format&fit=crop&q=80&w=800"; } }),
                            React.createElement('div', { className: "absolute bottom-0 left-0 p-4 bg-gradient-to-t from-black to-transparent w-full" }, React.createElement('h2', { className: "text-2xl font-black italic tracking-tighter text-white" }, bioOrganism.name.toUpperCase()))
                        ]),
                        React.createElement('div', { className: "w-full md:w-1/2 p-6 md:p-8 flex flex-col justify-center space-y-6 relative" }, [
                            React.createElement('div', { className: "absolute top-0 right-0 p-2 opacity-10", style: { color: activeTab.color } }, React.createElement(Microscope, { size: 100 })),
                            React.createElement('div', { className: "space-y-3 border-l-4 pl-4", style: { borderLeftColor: activeTab.color } }, [
                                React.createElement('p', { className: "text-xs font-mono uppercase tracking-widest", style: { color: activeTab.color } }, "CLASIFICACIÃ“N TAXONÃ“MICA"),
                                React.createElement('p', { className: "text-lg font-serif italic text-white" }, bioOrganism.scientific),
                            ]),
                            React.createElement('p', { className: "text-sm text-neutral-300" }, bioOrganism.desc),
                            React.createElement('div', { className: "p-4 rounded-lg border", style: { backgroundColor: `${activeTab.color}15`, borderColor: `${activeTab.color}40` } }, [
                                React.createElement('div', { className: "flex items-center gap-2 mb-2" }, [ React.createElement(Activity, { size: 14, style: { color: activeTab.color } }), React.createElement('span', { className: "text-[10px] font-black uppercase", style: { color: activeTab.color } }, "DATO VITAL") ]),
                                React.createElement('p', { className: "text-xs text-white opacity-80" }, bioOrganism.fact)
                            ])
                        ])
                    ])
                )
            ]);
        }

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(CommandCenterV7));
    </script>
    
    <script>
      if ('serviceWorker' in navigator) { window.addEventListener('load', () => { navigator.serviceWorker.register('./sw.js'); }); }
    </script>
</body>
</html>
