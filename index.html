<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>CMD V8.6:DeepClean</title>
<link rel="manifest" href="./manifest.json"><meta name="theme-color" content="#000">
<script src="https://cdn.tailwindcss.com"></script>
<script>tailwind.config={theme:{extend:{fontFamily:{sans:['Inter','sans-serif']}}}}</script>
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script src="https://apis.google.com/js/api.js" async defer></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;900&display=swap');
body{background:#000;touch-action:none;overscroll-behavior:none}.no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}
.glass{background:rgba(10,10,10,.85);backdrop-filter:blur(30px);-webkit-backdrop-filter:blur(30px);border-top:1px solid rgba(255,255,255,.1);box-shadow:0 -10px 50px #000}
.tr-h{transition:height .4s cubic-bezier(.2,.8,.2,1)}
@keyframes sl{0%{transform:translateY(-100%)}100%{transform:translateY(100%)}}
.scan::after{content:'';position:absolute;inset:0;background:linear-gradient(to bottom,transparent,#ffffff1a,transparent);animation:sl 2s linear infinite;pointer-events:none}
.drag-over{background:#ffffff0d;border-color:var(--theme-color);box-shadow:inset 0 0 20px #ffffff0d}.rich b{color:inherit;font-weight:900}

/* TRANSICIONES LIMPIAS (SIN BLUR) */
@keyframes slideUp { 
    from { opacity: 0; transform: translateY(25px); } 
    to { opacity: 1; transform: translateY(0); } 
}
@keyframes slideDown { 
    from { opacity: 0; transform: translateY(-25px); } 
    to { opacity: 1; transform: translateY(0); } 
}
.anim-n { animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
.anim-p { animation: slideDown 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
.fade-content { transition: opacity 0.2s ease-out; }
</style>
</head>
<body><div id="root"></div>
<script type="module">
import React,{useState,useEffect,useRef,useMemo}from'https://esm.sh/react@18.2.0';
import{createRoot}from'https://esm.sh/react-dom@18.2.0/client';
import*as L from'https://esm.sh/lucide-react@0.292.0';

const h=React.createElement, F=React.Fragment;
const ICONS={Calendar:L.Calendar,CheckSquare:L.CheckSquare,Target:L.Target,Folder:L.Folder,BookOpen:L.BookOpen,Menu:L.Menu,Settings:L.Settings,Clock:L.Clock,Dna:L.Dna,Microscope:L.Microscope,Activity:L.Activity,Leaf:L.Leaf,Zap:L.Zap,Globe:L.Globe,Database:L.Database,Cpu:L.Cpu,Layout:L.Layout,PenTool:L.PenTool,Hash:L.Hash,Briefcase:L.Briefcase,Terminal:L.Terminal,GraduationCap:L.GraduationCap,Dumbbell:L.Dumbbell,Edit3:L.Edit3,Plus:L.Plus,X:L.X,RefreshCw:L.RefreshCw,Trash2:L.Trash2,GripHorizontal:L.GripHorizontal,CheckCircle:L.CheckCircle,Eye:L.Eye,EyeOff:L.EyeOff};

const BIO=[{id:1,name:"Cuervo Grande",sci:"Corvus corax",tx:"Aves/Corvidae",desc:"Inteligencia primate. Usa herramientas.",fact:"Reconocen rostros y guardan rencor.",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/a/aa/Corvus_corax_%28Common_Raven%29.jpg/800px-Corvus_corax_%28Common_Raven%29.jpg"},{id:2,name:"Araña Saltadora",sci:"Phidippus audax",tx:"Arachnida/Salticidae",desc:"Depredador visual, quelíceros verdes.",fact:"Salta 50x su longitud.",img:"https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/Phidippus_audax_male.jpg/800px-Phidippus_audax_male.jpg"}];
const TABS=[{id:'t1',l:'EVENTOS',i:'Calendar',c:'#3b82f6'},{id:'t2',l:'TAREAS',i:'CheckSquare',c:'#ef4444'},{id:'t3',l:'NOTAS',i:'BookOpen',c:'#eab308'},{id:'t4',l:'PROY',i:'Folder',c:'#22c55e'}];
const Q={q1:{t:'HACER YA',s:'Urgente+Imp',c:'#ef4444'},q2:{t:'PLANIFICAR',s:'NoUrg+Imp',c:'#3b82f6'},q3:{t:'DELEGAR',s:'Urg+NoImp',c:'#eab308'},q4:{t:'ELIMINAR',s:'NiUrg+NiImp',c:'#64748b'}};

// UTILIDAD DE LIMPIEZA DE TEXTO (Global)
const norm = (str) => str ? str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase() : "";
const isAcademic = (txt) => {
    const clean = norm(txt);
    // Lista masiva de términos académicos
    const kw=['clase','aula','uni','curso','materia','taller','laboratorio','examen','parcial','final','recuperatorio','tp','entrega','catedra','teorico','practico','docente','profesor','profe','ayudante','jtp','comision','school','college','salon','b1','a1','pabellon','fadu','uba','unam','utn','quimica','biologia','matematica','fisica','historia','arte','diseño','analisis','algebra','anatomia','fisiologia','seminario','tesis','investigacion'];
    return kw.some(k => clean.includes(k));
};
const isFitness = (txt) => {
    const clean = norm(txt);
    const kw=['fit','gym','gimnasio','entren','ejercicio','sport','correr','nadar','fútbol','basquet','yoga','pilates'];
    return kw.some(k => clean.includes(k));
};

function App(){
    const [tabs,ST]=useState(TABS),[act,SA]=useState('t1'),[date,SD]=useState(new Date()),[evs,SE]=useState([]);
    const [modal,SM]=useState(null),[selId,SSI]=useState(null),[form,SF]=useState({title:'',date:'',time:'',type:'gen',notes:'',cat:'task',quad:'q2'});
    const [sets,SS]=useState(false),[cals,SC]=useState({}),[bioIx,SB]=useState(0),[bioShow,SBS]=useState(false);
    const [sync,SSy]=useState(false),[gCfg,SG]=useState({apiKey:'',clientId:''}),[gSign,SGS]=useState(false);
    const [dH,SH]=useState(40),[drag,SDr]=useState(false),[dragId,SDId]=useState(null);
    const [dir,SDir]=useState('n');
    const fM=useRef(new Set()),tC=useRef(null),gI=useRef(false),gsI=useRef(false),tS=useRef(null),tE=useRef(null),dY=useRef(0),dH0=useRef(0);
    const curTab=tabs.find(t=>t.id===act)||tabs[0], thStyle={'--theme-color':curTab.c,'--theme-glow':curTab.c+'60'};

    const ls=(k,v)=>v?localStorage.setItem(k,JSON.stringify(v)):JSON.parse(localStorage.getItem(k));
    useEffect(()=>{
        const e=ls('ev_v8'),t=ls('tb_v8'),g=ls('gc_v8'),c=ls('cm_v8');
        if(e)try{SE(e)}catch(x){}else SE([{id:1,title:'INIT_V8',date:new Date().toISOString().split('T')[0],time:'09:00',type:'work',cat:'task',quad:'q1'}]);
        if(t)ST(t);if(g)SG(g);if(c)SC(c);
        if(window.gapi)window.gapi.load('client',initGapi);
    },[]);
    useEffect(()=>{ls('ev_v8',evs);ls('tb_v8',tabs);ls('gc_v8',gCfg);ls('cm_v8',cals)},[evs,tabs,gCfg,cals]);
    useEffect(()=>{
        if(gSign&&gCfg.apiKey){
            const k=`${date.getFullYear()}-${date.getMonth()}`,nk=`${date.getFullYear()}-${date.getMonth()+1}`;
            if(!fM.current.has(k)||!fM.current.has(nk)) fetchG(date);
        }
    },[date,gSign]);

    const initGapi=async()=>{if(gCfg.apiKey){await window.gapi.client.init({apiKey:gCfg.apiKey,discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"]});gI.current=true}};
    const initGis=()=>{if(gCfg.clientId){tC.current=window.google.accounts.oauth2.initTokenClient({client_id:gCfg.clientId,scope:"https://www.googleapis.com/auth/calendar.readonly",callback:async(r)=>{if(!r.error){SGS(true);fM.current.clear();await fetchG(date)}}});gsI.current=true}};
    const auth=async()=>{if(!gCfg.apiKey||!gCfg.clientId)return alert("Faltan Credenciales");if(!gI.current)await initGapi();if(!gsI.current)initGis();setTimeout(()=>tC.current.requestAccessToken({prompt:'select_account'}),500)};
    
    // FETCH GOOGLE: DETECCION "DEEP CLEAN"
    const fetchG=async(td=new Date())=>{
        SSy(true);try{
            if(!window.gapi.client.calendar) await window.gapi.client.load('calendar','v3');
            const y=td.getFullYear(),m=td.getMonth(),min=new Date(y,m-1,1).toISOString(),max=new Date(y,m+2,0).toISOString();
            fM.current.add(`${y}-${m}`);fM.current.add(`${y}-${m+1}`);
            const cl=await window.gapi.client.calendar.calendarList.list(), rC=cl.result.items, uC={...cals};
            rC.forEach(c=>{if(!uC[c.id])uC[c.id]={id:c.id,summary:c.summary,color:c.backgroundColor,visible:true};else{uC[c.id].summary=c.summary;uC[c.id].color=c.backgroundColor}});
            SC(uC);
            const all=await Promise.all(rC.map(async c=>{
                if(cals[c.id]&&!cals[c.id].visible)return[];
                try{
                    const r=await window.gapi.client.calendar.events.list({calendarId:c.id,timeMin:min,timeMax:max,singleEvents:true,maxResults:999,orderBy:'startTime'});
                    return r.result.items.map(i=>{
                        const tText = i.summary || '';
                        const cText = c.summary || '';
                        let cat='task', q='q2'; 
                        
                        // Prioridad absoluta a detección académica
                        if(isAcademic(tText) || isAcademic(cText)){ cat='class'; q=null; }
                        else if(isFitness(tText) || isFitness(cText)){ cat='fitness'; q=null; }
                        
                        return {id:i.id,calId:c.id,title:i.summary||'(No Title)',date:i.start.dateTime?.split('T')[0]||i.start.date,time:i.start.dateTime?.split('T')[1].substring(0,5)||'',type:'google',notes:i.description||'',cat,quad:q,gCol:c.backgroundColor}
                    })
                }catch(e){return[]}
            }));
            const flat=all.flat(), map=new Map(flat.map(e=>[e.id,e]));
            SE(p=>{
                const loc=p.filter(e=>e.type!=='google'), goog=p.filter(e=>e.type==='google' && (e.date<min.split('T')[0]||e.date>max.split('T')[0]));
                const merged=new Map(); loc.forEach(e=>merged.set(e.id,e)); goog.forEach(e=>merged.set(e.id,e)); flat.forEach(e=>merged.set(e.id,e));
                return Array.from(merged.values())
            });
        }catch(e){console.error(e)}finally{SSy(false)};
    };

    const days=useMemo(()=>{
        const y=date.getFullYear(),m=date.getMonth(),d=[],last=new Date(y,m+1,0).getDate(),pad=(new Date(y,m,1).getDay()||7)-1;
        for(let i=0;i<pad;i++)d.push({d:'',dt:null}); for(let i=1;i<=last;i++)d.push({d:i,dt:new Date(y,m,i).toISOString().split('T')[0]});
        return d;
    },[date]);

    // LOGICA DE DATOS: MATRIZ BLINDADA
    const {lk,mx,upGrouped}=useMemo(()=>{
        const l={},m=[],u=[],now=new Date().toISOString().split('T')[0];
        evs.forEach(e=>{
            if(e.type==='google'&&cals[e.calId]&&!cals[e.calId].visible)return;
            // Calendario
            if(e.date){if(!l[e.date])l[e.date]=[];l[e.date].push(e)}
            
            // Matriz (Tareas): DOBLE CHECK. Si isAcademic detecta algo, SE VA.
            // Esto atrapa eventos que quizas no se categorizaron bien al principio.
            const isAcad = isAcademic(e.title) || (e.cat === 'class');
            const isFit = isFitness(e.title) || (e.cat === 'fitness');
            
            if(!isAcad && !isFit) m.push(e);
            
            // Drawer (Upcoming)
            if(e.date>=now)u.push(e);
        });
        
        Object.keys(l).forEach(k=>l[k].sort((a,b)=>(a.time||'').localeCompare(b.time||'')));
        u.sort((a,b)=>a.date.localeCompare(b.date)||(a.time||'').localeCompare(b.time||''));

        // Agrupación por día para el Drawer
        const gr={};
        u.slice(0,60).forEach(e=>{
            if(!gr[e.date])gr[e.date]=[];
            gr[e.date].push(e);
        });
        const upG = Object.entries(gr).sort((a,b)=>a[0].localeCompare(b[0]));

        return {lk:l,mx:m,upGrouped:upG};
    },[evs,cals]);

    const calTouch={
        s:e=>{tE.current=null;tS.current=e.targetTouches[0].clientX},
        e:()=>{if(!tS.current||!tE.current)return; const d=tS.current-tE.current;
        if(Math.abs(d)>50){ SDir(d>0?'n':'p'); SD(new Date(date.getFullYear(),date.getMonth()+(d>0?1:-1),1)); }}
    };
    const drwTouch={
        s:e=>{SDr(true);dY.current=e.touches[0].clientY;dH0.current=dH},
        m:e=>{if(drag) SH(Math.min(window.innerHeight-50,Math.max(40,dH0.current+(dY.current-e.touches[0].clientY))))},
        e:()=>{SDr(false);const h=window.innerHeight; SH(dH>h*.75?h-20:dH>h*.3?h*.5:40)}
    };

    const saveEv=()=>{
        const pl={...form,id:modal==='c'?Date.now():selId};
        SE(modal==='c'?[...evs,pl]:evs.map(e=>e.id===selId?pl:e)); SM(null);
    };

    const Icon=(n,s=18,c)=>h(ICONS[n]||L.Circle,{size:s,className:c});
    
    // FORMAT FECHA DRAWER
    const fmtD=(ds)=>{
        const d=new Date(ds+'T12:00:00');
        return d.toLocaleDateString('es',{weekday:'short',day:'numeric'}).toUpperCase();
    }

    return h('div',{className:"h-screen w-screen bg-black text-slate-200 font-sans overflow-hidden flex flex-col relative",style:thStyle},
        h('div',{className:"absolute inset-0 pointer-events-none"},
            h('div',{className:"absolute inset-0 opacity-10",style:{backgroundImage:`radial-gradient(circle at 50% 0%,var(--theme-color),transparent 80%)`}}),
            h('div',{className:"absolute inset-0 opacity-20",style:{backgroundImage:`linear-gradient(#222 1px,transparent 1px),linear-gradient(90deg,#222 1px,transparent 1px)`,backgroundSize:'40px 40px'}})
        ),
        // HEADER
        h('header',{className:"z-20 flex flex-col pt-2 bg-black/90 border-b border-white/10 shrink-0"},
            h('div',{className:"flex overflow-x-auto no-scrollbar px-4 gap-2"}, tabs.map(t=>
                h('button',{key:t.id,onClick:()=>SA(t.id),style:{borderColor:act===t.id?t.c:'transparent',color:act===t.id?t.c:'#525252',backgroundColor:act===t.id?t.c+'10':'transparent'},className:"flex items-center gap-2 px-6 py-4 rounded-t-lg text-sm font-black tracking-widest transition-all border-b-4 hover:bg-white/5 uppercase shrink-0"},Icon(t.i),t.l)
            ))
        ),
        // MAIN
        h('main',{className:"flex-1 px-2 pb-2 md:px-6 md:pb-8 overflow-hidden flex flex-col z-10"},
            h('div',{className:"py-4 flex justify-between shrink-0"},
                h('div',{className:"flex items-baseline gap-2"},
                    h('h1',{className:"text-4xl md:text-5xl font-black text-white tracking-tighter leading-none"}, act==='t2'?"MATRIZ":date.toLocaleString('es-ES',{month:'long'}).toUpperCase()),
                    act==='t1'&&h('span',{className:"text-neutral-500 font-bold text-2xl"},date.getFullYear())
                ),
                h('div',{className:"flex gap-3"},
                    act==='t1'&&h('button',{onClick:()=>SD(new Date()),className:"hidden md:block px-4 py-1 text-xs font-bold text-neutral-400 border border-neutral-800 rounded-lg"},"HOY"),
                    h('button',{onClick:gSign?()=>fetchG(date):auth,className:`flex items-center gap-2 px-3 py-2 rounded-lg border bg-neutral-900 active:scale-95 ${sync?'border-[var(--theme-color)] text-[var(--theme-color)]':'border-neutral-800 text-neutral-400'}`},Icon('RefreshCw',18,sync?'animate-spin':''),h('span',{className:"hidden md:inline text-[10px] font-black"},"SYNC")),
                    h('button',{onClick:()=>SS(true),className:"p-2.5 rounded-lg bg-neutral-900 border border-neutral-800 text-neutral-400"},Icon('Settings',20))
                )
            ),
            act==='t2' // MATRIX
            ? h('div',{className:"flex-1 overflow-hidden grid grid-cols-1 md:grid-cols-2 grid-rows-2 gap-2 pb-20 md:pb-0"}, Object.keys(Q).map(k=>
                h('div',{key:k,onDragOver:e=>{e.preventDefault();e.currentTarget.classList.add('drag-over')},onDragLeave:e=>e.currentTarget.classList.remove('drag-over'),onDrop:e=>{e.preventDefault();e.currentTarget.classList.remove('drag-over');if(dragId)SE(prev=>prev.map(x=>x.id===dragId?{...x,quad:k}:x));SDId(null)},className:"bg-neutral-900/40 border border-neutral-800/60 rounded-xl p-3 flex flex-col relative overflow-hidden backdrop-blur-sm"},
                    h('div',{className:"flex justify-between items-center mb-3 pb-2 border-b border-white/5"},
                        h('div',{},h('h3',{className:"text-sm font-black tracking-widest",style:{color:Q[k].c}},Q[k].t),h('span',{className:"text-[9px] text-neutral-500 font-mono uppercase"},Q[k].s)),
                        h('span',{className:"bg-neutral-800 text-neutral-400 text-[10px] font-bold px-2 py-0.5 rounded-full"},mx.filter(e=>(e.quad||'q2')===k).length)
                    ),
                    h('div',{className:"flex-1 overflow-y-auto space-y-2 no-scrollbar"}, mx.filter(e=>(e.quad||'q2')===k).map(e=>
                        h('div',{key:e.id,draggable:true,onDragStart:ev=>{SDId(e.id);ev.dataTransfer.effectAllowed="move"},onClick:()=>{SF({...e});SSI(e.id);SM('e')},className:"bg-black/60 border border-neutral-800 hover:border-white/30 p-2.5 rounded-lg group transition-all active:scale-95"},
                            h('div',{className:"flex items-start gap-2"},h('div',{className:"mt-0.5 text-emerald-400"},Icon('CheckCircle',14)),h('div',{className:"flex-1 min-w-0"},h('p',{className:"text-xs font-bold text-white truncate rich",dangerouslySetInnerHTML:{__html:e.title}})),Icon('GripHorizontal',14,"text-neutral-700"))
                        )
                    ))
                )
            )) // CALENDAR
            : h('div',{onTouchStart:calTouch.s,onTouchMove:e=>tE.current=e.targetTouches[0].clientX,onTouchEnd:calTouch.e,className:"flex-1 bg-neutral-900/30 backdrop-blur-sm rounded-xl border border-neutral-800 overflow-hidden flex flex-col relative shadow-[0_0_100px_rgba(0,0,0,0.5)]"},
                h('div',{className:"grid grid-cols-7 bg-black border-b border-neutral-800"},['L','M','X','J','V','S','D'].map(d=>h('div',{key:d,className:"py-2 text-center text-[10px] md:text-xs font-black tracking-[0.2em] text-neutral-600"},d))),
                h('div',{key:date.toISOString(),className:`grid grid-cols-7 flex-1 auto-rows-fr ${dir==='n'?'anim-n':'anim-p'}`}, days.map((d,i)=>{
                    const isT=d.dt===new Date().toISOString().split('T')[0], evs=d.dt?(lk[d.dt]||[]):[];
                    return h('div',{key:i,onClick:()=>{if(d.dt){SF({title:'',date:d.dt,time:'09:00',type:'gen',notes:'',cat:'task',quad:'q2'});SM('c')}},className:`relative border-r border-b border-neutral-800/40 p-1 md:p-2 cursor-pointer group hover:bg-neutral-900`,style:isT?{background:curTab.c+'1A',borderColor:curTab.c,boxShadow:`0 0 15px ${curTab.c}30`,zIndex:10,fontWeight:900}:null},
                        d.d&&h('span',{className:`text-xs font-bold flex items-center justify-center w-6 h-6 rounded ${!isT?'text-neutral-600 group-hover:text-white':''}`,style:isT?{background:curTab.c,color:'black'}:null},d.d),
                        h('div',{className:"mt-1 flex flex-col gap-1 overflow-y-auto max-h-[80px] no-scrollbar"},evs.map(e=>
                            h('div',{key:e.id,onClick:ev=>{ev.stopPropagation();SF({...e});SSI(e.id);SM('e')},className:"text-[9px] md:text-[10px] font-bold truncate px-1.5 py-0.5 rounded border-l-[3px] hover:brightness-125",style:{borderLeftColor:e.gCol||curTab.c,backgroundColor:(e.gCol||curTab.c)+'20',color:'#e2e8f0'}},
                                (e.cat==='class'||isAcademic(e.title))&&Icon('GraduationCap',8,"inline mr-1"),(e.cat==='fitness'||isFitness(e.title))&&Icon('Dumbbell',8,"inline mr-1"),e.time+' '+e.title
                            )
                        ))
                    )
                }))
            )
        ),
        // DRAWER - UPGRADED: APILA POR DIA
        h('div',{className:`fixed bottom-0 left-0 right-[60px] z-50 rounded-tr-2xl glass flex flex-col ${!drag?'tr-h':''}`,style:{height:dH}},
            h('div',{className:"w-full h-8 flex justify-center items-center cursor-grab touch-none shrink-0",onTouchStart:drwTouch.s,onTouchMove:drwTouch.m,onTouchEnd:drwTouch.e},h('div',{className:"w-16 h-1 bg-white/30 rounded-full"})),
            // Contenedor de Grupos
            h('div',{className:`flex-1 overflow-x-auto p-4 flex gap-6 no-scrollbar fade-content ${dH<80?'opacity-0 pointer-events-none':'opacity-100'}`}, upGrouped.length?upGrouped.map(([dStr,evs])=>
                h('div',{key:dStr,className:"flex flex-col gap-2 min-w-[200px]"},
                    h('div',{className:"sticky top-0 z-10"},h('span',{className:"text-[10px] font-black tracking-widest text-neutral-500 uppercase bg-black/50 px-2 py-1 rounded"},fmtD(dStr))),
                    evs.map(e=>
                        h('div',{key:e.id,onClick:()=>{SF({...e});SSI(e.id);SM('e')},className:"w-full bg-black/40 border-l-4 p-3 rounded hover:brightness-125 cursor-pointer backdrop-blur-sm transition-transform active:scale-95",style:{borderLeftColor:e.gCol||'white'}},
                            h('div',{className:"flex justify-between items-start mb-1"},h('span',{className:"text-xs font-bold text-white truncate"},e.title),h('span',{className:"text-[9px] text-neutral-400 font-mono"},e.time)),
                            (e.cat==='class'||isAcademic(e.title))&&h('div',{className:"text-[9px] text-blue-300 font-bold"},"CLASE"),
                            e.notes&&h('div',{className:"text-[9px] text-neutral-500 line-clamp-1 italic",dangerouslySetInnerHTML:{__html:e.notes}})
                        )
                    )
                )
            ):h('div',{className:"w-full text-center text-neutral-500 text-xs italic"},"No upcoming events"))
        ),
        // BIO WIDGET
        h('div',{onClick:()=>{SB(BIO.length>1?Math.floor(Math.random()*BIO.length):0);SBS(true)},className:`fixed bottom-0 right-0 w-32 z-[60] flex items-center justify-center cursor-pointer hover:bg-black/50 overflow-hidden rounded-tl-[30px] group shadow-[0_0_30px_#000c] backdrop-blur-md ${!drag?'tr-h':''}`,style:{height:dH,background:'#0006',borderLeft:`2px solid ${curTab.c}`,borderTop:`2px solid ${curTab.c}`}},
            Icon('Dna',28,`group-hover:animate-spin transition-transform duration-700 text-[${curTab.c}]`)
        ),
        // MODALS
        (sets||modal||bioShow)&&h('div',{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/90 backdrop-blur-md p-4 animate-in fade-in"},
            sets?h('div',{className:"w-full max-w-2xl h-[80vh] bg-neutral-900 border border-neutral-700 rounded-2xl overflow-hidden shadow-2xl flex flex-col"},
                h('div',{className:"p-4 bg-black flex justify-between border-b border-neutral-800"},h('h3',{className:"font-bold text-white"},"CONFIG"),h('button',{onClick:()=>SS(false)},Icon('X'))),
                h('div',{className:"p-6 space-y-6 overflow-y-auto"},
                    h('div',{},h('h4',{className:"text-xs font-bold text-neutral-500 uppercase border-b border-neutral-800 pb-2"},"Calendarios"),Object.values(cals).map(c=>h('div',{key:c.id,className:"flex justify-between p-3 border-b border-neutral-800"},h('span',{style:{color:c.color}},c.summary),h('button',{onClick:()=>SC(p=>({...p,[c.id]:{...p[c.id],visible:!p[c.id].visible}}))},Icon(c.visible?'Eye':'EyeOff'))))),
                    h('div',{},h('h4',{className:"text-xs font-bold text-neutral-500 uppercase border-b border-neutral-800 pb-2"},"Estilo"),tabs.map(t=>h('div',{key:t.id,className:"flex items-center gap-4 mt-2"},h('input',{type:'color',value:t.c,onChange:e=>ST(tabs.map(tb=>tb.id===t.id?{...tb,c:e.target.value}:tb)),className:"w-8 h-8 bg-transparent"}),h('input',{value:t.l,onChange:e=>ST(tabs.map(tb=>tb.id===t.id?{...tb,l:e.target.value}:tb)),className:"bg-transparent text-white font-bold"})))),
                    h('div',{},h('h4',{className:"text-xs font-bold text-neutral-500 uppercase border-b border-neutral-800 pb-2"},"Google API"),h('input',{placeholder:"Client ID",value:gCfg.clientId,onChange:e=>SG({...gCfg,clientId:e.target.value}),className:"w-full bg-black border-b border-neutral-700 text-xs p-2 text-white outline-none mt-2"}),h('input',{placeholder:"API Key",value:gCfg.apiKey,onChange:e=>SG({...gCfg,apiKey:e.target.value}),className:"w-full bg-black border-b border-neutral-700 text-xs p-2 text-white outline-none mt-2"}))
                )
            ):bioShow?h('div',{className:"w-full max-w-3xl rounded-lg overflow-hidden flex flex-col md:flex-row relative shadow-2xl bg-neutral-900 border",style:{borderColor:curTab.c}},
                h('button',{onClick:()=>SBS(false),className:"absolute top-4 right-4 z-50 text-white"},Icon('X')),
                h('div',{className:"w-full md:w-1/2 h-64 md:h-auto relative scan overflow-hidden bg-black"},h('img',{src:BIO[bioIx].img,className:"w-full h-full object-cover opacity-80"}),h('div',{className:"absolute bottom-0 left-0 p-4 bg-gradient-to-t from-black w-full"},h('h2',{className:"text-2xl font-black italic text-white"},BIO[bioIx].name))),
                h('div',{className:"w-full md:w-1/2 p-6 flex flex-col justify-center space-y-4"},h('p',{className:"text-lg italic text-white"},BIO[bioIx].sci),h('p',{className:"text-sm text-neutral-300"},BIO[bioIx].desc),h('div',{className:"p-3 rounded border",style:{borderColor:curTab.c,background:curTab.c+'15'}},h('p',{className:"text-xs text-white"},BIO[bioIx].fact)))
            ):h('div',{className:"w-full max-w-md bg-neutral-900 border border-neutral-700 rounded-2xl overflow-hidden shadow-2xl flex flex-col"},
                h('div',{className:"p-4 bg-black flex justify-between border-b border-neutral-800"},h('span',{className:"font-bold text-white"},modal==='e'?'EDITAR':'NUEVO'),h('button',{onClick:()=>SM(null)},Icon('X'))),
                h('div',{className:"p-5 space-y-4"},
                    h('div',{className:"flex gap-2"},[{id:'task',l:'TAREA',i:'CheckSquare'},{id:'class',l:'CLASE',i:'GraduationCap'},{id:'fitness',l:'GYM',i:'Dumbbell'}].map(c=>h('button',{key:c.id,onClick:()=>SF({...form,cat:c.id}),className:`flex-1 py-2 rounded border text-xs font-black ${form.cat===c.id?'bg-[var(--theme-color)] text-black':'text-neutral-500 border-neutral-700'}`},Icon(c.i,12,"inline mr-1"),c.l))),
                    h('input',{autoFocus:true,placeholder:"Título...",className:"w-full bg-black border border-neutral-700 rounded p-3 text-white font-bold outline-none",value:form.title,onChange:e=>SF({...form,title:e.target.value})}),
                    !['class','fitness'].includes(form.cat)&&h('div',{className:"grid grid-cols-2 gap-2"},Object.values(Q).map(q=>h('button',{key:q.t,onClick:()=>SF({...form,quad:Object.keys(Q).find(k=>Q[k]===q)}),className:`p-2 rounded border text-[10px] font-bold uppercase ${form.quad===Object.keys(Q).find(k=>Q[k]===q)?'bg-white/10 text-white':'text-neutral-600 border-neutral-800'}`},q.t))),
                    h('div',{className:"grid grid-cols-2 gap-3"},h('input',{type:'date',className:"bg-black border border-neutral-700 rounded p-2 text-white",value:form.date,onChange:e=>SF({...form,date:e.target.value})}),h('input',{type:'time',className:"bg-black border border-neutral-700 rounded p-2 text-white",value:form.time,onChange:e=>SF({...form,time:e.target.value})})),
                    h('textarea',{rows:3,className:"w-full bg-black border border-neutral-700 rounded p-3 text-sm text-neutral-300 outline-none",placeholder:"Notas...",value:form.notes,onChange:e=>SF({...form,notes:e.target.value})}),
                    h('div',{className:"flex gap-3"},modal==='e'&&h('button',{onClick:()=>{SE(evs.filter(e=>e.id!==selId));SM(null)},className:"p-3 rounded bg-red-900/20 text-red-500 border border-red-900"},Icon('Trash2')),h('button',{onClick:saveEv,className:"flex-1 py-3 rounded bg-[var(--theme-color)] text-black font-black"},"CONFIRMAR"))
                )
            )
        )
    );
}
const root=createRoot(document.getElementById('root'));root.render(h(App));
</script>
<script>if('serviceWorker'in navigator)window.addEventListener('load',()=>navigator.serviceWorker.register('./sw.js'));</script>
</body>
</html>
